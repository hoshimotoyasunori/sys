# 機能仕様書

## 1. 概要

### 1.1 目的
システム設計プロジェクトの管理と支援を行うWebアプリケーションの機能仕様を定義する。

### 1.2 対象読者
- 開発者
- プロジェクトマネージャー
- システム設計者
- エンドユーザー

### 1.3 適用範囲
本仕様書は、システム設計アシスタントの全機能について記述する。

## 2. システム概要

### 2.1 システム名
システム設計アシスタント

### 2.2 システム概要
プロジェクト管理とシステム設計を支援するWebアプリケーション。デスクトップとモバイルの両方に対応したレスポンシブデザインを採用。

### 2.3 主要機能
1. プロジェクト管理機能
2. システム設計支援機能
3. モバイル対応機能
4. 招待システム機能
5. ドキュメント管理機能
6. UI/UX機能

## 3. 機能要件

### 3.1 認証・認可機能

#### 3.1.1 ユーザー認証
- **機能名**: ユーザー認証
- **概要**: Supabase Authを使用したユーザー認証
- **入力**: メールアドレス、パスワード
- **処理**: 
  - ログイン処理
  - ログアウト処理
  - セッション管理
- **出力**: 認証状態、ユーザー情報
- **制約**: パスワードは8文字以上

#### 3.1.2 権限管理
- **機能名**: 権限管理
- **概要**: プロジェクト内での権限管理
- **権限レベル**:
  - オーナー: 全権限
  - 管理者: プロジェクト管理権限
  - メンバー: 閲覧・編集権限

### 3.2 プロジェクト管理機能

#### 3.2.1 プロジェクト作成
- **機能名**: プロジェクト作成
- **概要**: 新しいプロジェクトを作成
- **入力**: プロジェクト名、説明（任意）
- **処理**: 
  - プロジェクト情報の保存
  - 初期フェーズの作成
  - 初期タスク・成果物の作成
- **出力**: 作成されたプロジェクト情報

#### 3.2.2 プロジェクト削除
- **機能名**: プロジェクト削除
- **概要**: プロジェクトを削除
- **入力**: プロジェクトID
- **処理**: 
  - 関連データの削除
  - メンバー情報の削除
- **出力**: 削除完了通知
- **制約**: オーナーのみ実行可能

#### 3.2.3 プロジェクト切り替え
- **機能名**: プロジェクト切り替え
- **概要**: 別のプロジェクトに切り替え
- **入力**: プロジェクトID
- **処理**: 
  - 現在のプロジェクト情報の更新
  - 関連データの読み込み
- **出力**: 切り替え後のプロジェクト情報

#### 3.2.4 プロジェクトメンバー管理
- **機能名**: プロジェクトメンバー管理
- **概要**: プロジェクトメンバーの招待・管理
- **機能**:
  - メンバー招待（メール送信）
  - メンバー一覧表示
  - 権限変更
  - メンバー削除

### 3.3 システム設計支援機能

#### 3.3.1 フェーズ管理
- **機能名**: フェーズ管理
- **概要**: 4つのフェーズの管理
- **フェーズ**:
  1. 要件定義
  2. 基本設計
  3. 外部設計
  4. 開発準備

#### 3.3.2 タスク管理
- **機能名**: タスク管理
- **概要**: フェーズ別タスクの管理
- **機能**:
  - タスクの表示
  - タスクの完了/未完了切り替え
  - 優先度管理
  - 進捗の可視化

#### 3.3.3 成果物管理
- **機能名**: 成果物管理
- **概要**: フェーズ別成果物の管理
- **機能**:
  - 成果物の表示
  - ステータス管理（未着手/進行中/完了）
  - 成果物チェックリスト
  - 進捗の可視化

#### 3.3.4 進捗管理
- **機能名**: 進捗管理
- **概要**: プロジェクト全体の進捗管理
- **機能**:
  - 全体進捗の表示
  - フェーズ別進捗の表示
  - 進捗率の計算
  - 進捗グラフの表示

### 3.4 モバイル対応機能

#### 3.4.1 レスポンシブデザイン
- **機能名**: レスポンシブデザイン
- **概要**: 画面サイズに応じたUI調整
- **対応サイズ**:
  - デスクトップ（1024px以上）
  - タブレット（768px-1023px）
  - モバイル（767px以下）

#### 3.4.2 モバイルナビゲーション
- **機能名**: モバイルナビゲーション
- **概要**: モバイル向けのナビゲーション
- **機能**:
  - モーダルメニュー
  - タッチフレンドリーなUI
  - スワイプ操作対応

#### 3.4.3 PWA対応
- **機能名**: PWA対応
- **概要**: Progressive Web App対応
- **機能**:
  - オフライン対応
  - ホーム画面への追加
  - プッシュ通知

### 3.5 招待システム機能

#### 3.5.1 メール招待
- **機能名**: メール招待
- **概要**: プロジェクトメンバーのメール招待
- **機能**:
  - 招待メールの送信（Resend API）
  - 招待リンクの生成
  - 招待の受け入れ・辞退

#### 3.5.2 招待管理
- **機能名**: 招待管理
- **概要**: 招待の状態管理
- **機能**:
  - 招待状態の表示
  - 招待の取り消し
  - 招待履歴の管理

### 3.6 ドキュメント管理機能

#### 3.6.1 テンプレート機能
- **機能名**: テンプレート機能
- **概要**: システム設計用テンプレートの提供
- **機能**:
  - 要件定義テンプレート
  - 基本設計テンプレート
  - 外部設計テンプレート
  - 開発準備テンプレート

#### 3.6.2 ダウンロード機能
- **機能名**: ダウンロード機能
- **概要**: テンプレートのダウンロード
- **機能**:
  - PDF形式でのダウンロード
  - Word形式でのダウンロード
  - カスタマイズ可能なテンプレート

#### 3.6.3 ドキュメント整理
- **機能名**: ドキュメント整理
- **概要**: プロジェクトドキュメントの整理
- **機能**:
  - ドキュメントの分類
  - 検索機能
  - バージョン管理

### 3.7 UI/UX機能

#### 3.7.1 ダークモード
- **機能名**: ダークモード
- **概要**: ダークテーマの切り替え
- **機能**:
  - テーマの切り替え
  - 設定の保存
  - 自動切り替え

#### 3.7.2 アニメーション
- **機能名**: アニメーション
- **概要**: UI要素のアニメーション
- **機能**:
  - ページ遷移アニメーション
  - ボタンアニメーション
  - ローディングアニメーション

#### 3.7.3 通知機能
- **機能名**: 通知機能
- **概要**: リアルタイム通知
- **機能**:
  - 成功通知
  - エラー通知
  - 情報通知

## 4. 非機能要件

### 4.1 性能要件
- ページ読み込み時間: 3秒以内
- レスポンス時間: 1秒以内
- 同時接続数: 100ユーザー

### 4.2 可用性要件
- 稼働率: 99.9%
- メンテナンス時間: 月1回、2時間以内

### 4.3 セキュリティ要件
- HTTPS通信の必須
- パスワードの暗号化
- セッション管理
- CSRF対策

### 4.4 保守性要件
- モジュール化された設計
- 適切なコメント
- バージョン管理

## 5. 画面仕様

### 5.1 ログイン画面
- **画面名**: ログイン画面
- **概要**: ユーザー認証画面
- **要素**:
  - メールアドレス入力欄
  - パスワード入力欄
  - ログインボタン
  - 新規登録リンク

### 5.2 プロジェクト選択画面
- **画面名**: プロジェクト選択画面
- **概要**: プロジェクトの選択・作成画面
- **要素**:
  - プロジェクト一覧
  - プロジェクト作成ボタン
  - プロジェクト切り替えボタン

### 5.3 メイン画面（デスクトップ）
- **画面名**: メイン画面（デスクトップ）
- **概要**: システム設計支援のメイン画面
- **要素**:
  - ヘッダー
  - サイドバー
  - メインコンテンツ
  - フェーズタブ
  - タスク・成果物表示

### 5.4 メイン画面（モバイル）
- **画面名**: メイン画面（モバイル）
- **概要**: モバイル向けメイン画面
- **要素**:
  - ヘッダー
  - フェーズナビゲーション
  - モーダルメニュー
  - タスク・成果物表示

### 5.5 成果物チェックリスト画面
- **画面名**: 成果物チェックリスト画面
- **概要**: 成果物の進捗管理画面
- **要素**:
  - 全体進捗表示
  - フィルター機能
  - 成果物一覧
  - ステータス変更機能

### 5.6 テンプレート画面
- **画面名**: テンプレート画面
- **概要**: テンプレートの表示・ダウンロード画面
- **要素**:
  - テンプレート一覧
  - プレビュー機能
  - ダウンロードボタン
  - カスタマイズ機能

## 6. データ仕様

### 6.1 ユーザーデータ
```typescript
interface User {
  id: string;
  email: string;
  created_at: string;
  updated_at: string;
}
```

### 6.2 プロジェクトデータ
```typescript
interface Project {
  id: string;
  name: string;
  description?: string;
  owner_id: string;
  created_at: string;
  updated_at: string;
}
```

### 6.3 フェーズデータ
```typescript
interface Phase {
  id: string;
  project_id: string;
  name: string;
  description: string;
  order_index: number;
  created_at: string;
  updated_at: string;
}
```

### 6.4 タスクデータ
```typescript
interface Task {
  id: string;
  project_id: string;
  phase_id: string;
  title: string;
  description: string;
  status: 'todo' | 'in-progress' | 'completed';
  priority: 'high' | 'medium' | 'low';
  order_index: number;
  created_at: string;
  updated_at: string;
}
```

### 6.5 成果物データ
```typescript
interface Deliverable {
  id: string;
  project_id: string;
  phase_id: string;
  name: string;
  description?: string;
  type: 'document' | 'design' | 'code' | 'other';
  status: 'pending' | 'in-progress' | 'completed';
  order_index: number;
  created_at: string;
  updated_at: string;
}
```

## 7. 外部連携

### 7.1 Supabase
- **用途**: データベース、認証、リアルタイム機能
- **API**: Supabase JavaScript Client

### 7.2 Resend API
- **用途**: メール送信
- **機能**: 招待メールの送信

### 7.3 Vercel
- **用途**: デプロイメント
- **機能**: 自動デプロイ、CDN配信

## 8. エラーハンドリング

### 8.1 認証エラー
- ログイン失敗時のメッセージ表示
- セッション切れ時の自動ログアウト

### 8.2 ネットワークエラー
- 接続失敗時のリトライ機能
- オフライン時のキャッシュ表示

### 8.3 データベースエラー
- データ取得失敗時のフォールバック
- 保存失敗時のエラーメッセージ表示

## 9. テスト要件

### 9.1 単体テスト
- コンポーネントの動作テスト
- ユーティリティ関数のテスト

### 9.2 統合テスト
- API連携のテスト
- データベース操作のテスト

### 9.3 E2Eテスト
- ユーザーフローのテスト
- ブラウザ互換性のテスト

## 10. 運用要件

### 10.1 監視
- アプリケーションの稼働監視
- エラーログの収集

### 10.2 バックアップ
- データベースの定期バックアップ
- 設定ファイルのバックアップ

### 10.3 セキュリティ
- 定期的なセキュリティ監査
- 脆弱性の修正

## 11. 制約事項

### 11.1 技術的制約
- ブラウザの互換性
- ネットワーク環境の依存

### 11.2 運用制約
- メンテナンス時間の制約
- データ容量の制約

## 12. 将来拡張

### 12.1 予定機能
- チャット機能
- ファイルアップロード機能
- レポート生成機能

### 12.2 技術的拡張
- マイクロサービス化
- コンテナ化
- CI/CDパイプラインの改善 